<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz</title>
	<style>
body{
	margin:0px;
	padding:0px;
	background-color:#d0ebfb;
        font-family: 'Crimson Pro', serif;
}
.mk{vertical-align: middle;}

.imgCon{background-color:#fff;}

.imgCon img{max-width:100%;}

ol{ padding:20px;
    max-width: 310px;
    margin: auto;}

#ti{
	position:fixed;
	top:0px;
	right:0px;}
#ti, .start, .ti {display:inline-block;
	background-color:#009;
	color:white;
	padding:6px;
	cursor:pointer;
	font-size:26px;
	margin:0px 1px;
}
.hh{
	background-color:#e0fbfb;
	font-size:20px;
	padding:6px;
	margin-bottom: 6px;
	}
.ce{text-align:center;}
#end, .v{width:100%;height:100vh;}

.roundIt{border-radius:11px; background-color:#fff;
	border:none;
	font-size:17px;
	padding:10px 5px;
	margin:5px 0px;
  box-shadow: 3px 3px 3px #bcc0d2;
}

.tabler, .tabler th, .tabler td {
    border: none;
    text-align: left;
    padding: 8px;
	border-left: 1px solid #aaa;
}
.tabler tbody tr:nth-child(2n) {
    background-color: #F7D5A2;
}
.tabler {
    border-collapse: collapse;
    border-spacing: 0;
width: 100%;
	border: 1px solid #aaa;
	margin-bottom:15px;
}

.trA {
    background-color: #090;
    color: #FFF;
}
.red{color:red;}
.inp{margin-top: 20px;}
.co{display: none;}
</style>
</head>
<body>
	<div id="reg_page" class ="ce co" style="padding: 10px;display: block;" >
How far can you go in 180 seconds?

<div id="caption" style="font-size:50px;padding-top:15px;">

<img src="images/biology_quiz2.png" style="max-width:200px; margin:auto;" alt="Biology Quiz" />
</div>
<div id="ti2"> Time duration: 3 minutes</div>
<u><strong>Instruction</strong></u> : This quiz is meant for secondary school students, WAEC,GCE,NECO and JAMB candidates.
<hr />
  		<form id="reg_me">
Enter Your phone number, name &amp; surname to redeem your price if your win.
<br />
<div class="inp">
<input id="Uphone" name="phone" class="roundIt" type="tel" placeholder="Phone Number:" required="required" />
<div id="phone_complain" class="red"></div>
</div>

<div class="inp">
	Enter your first name and middle name<br />
	<input id="name" name="uname" type="text" class="roundIt" placeholder="Name:" required="required" />
	<div id="name_complain" class="red"></div>
</div>

<div class="inp">
	Enter your surname<br />
	<input id="surname" name="surname" type="text" class="roundIt" placeholder="Surname:" required="required" />
	<div id="surname_complain" class="red"></div>
</div>

<input type="hidden" name="reg" value="reg" />
<input type="submit" id="testo" class="start" style="
	font-size:20px;border: none;" value="Send" />

		</form>
<!--
How much can you label right in 60 sec
-->
		</div>
		
		<div id="scoreBoard" class="co">

			<button id="back_btn"> Back </button>			
      <img src="images/ScoreBoard.jpg" style="width:100%;" alt="Score Board" />

			<h1>Data from Firestore</h1>
			<ul id="data-list"></ul>

			<div id="score"></div>
		</div>

		<div id="loading" class="co ce" style="padding-top: 50px;">
			<div id="messa" style="margin: 20px;font-size: 20px;"> ...Loading </div>
      
			<div class='past_result start' style='font-size:30px;' >Past Results</div>
	
			<div style='padding-top:15px;'>
				For more exercises: download the APP for <br />
				Biology Practical Activity &amp; Work Book 1 - 3.<br />
	
				<a href='https://youngbrain.com.ng/app'>
					<div class='start' style='font-size:30px;' onclick='again()'>Biology_App</div>
				</a>
	
				<br /> For more information, visit our facebook page<br /><a
					href="https://www.facebook.com/Youngbrain-publishers-ltd-103972044777696/">Youngbrain Publishers Ltd </a>
			</div>
		</div>

		<div id="msg" class="co ce" style="padding-top: 100px;">	
			
			<div id='caption' style='font-size:50px;padding-top:30px;'>
				Ready? <br />
			</div>
			<div id="message"></div>
			<div id="start_ready" class='start' style='font-size:30px;'>Start</div>

		</div>
	
		<div id='end' class='co ce' >
			<div id='ti3' class='ti'> Time up</div>
			<div id='sco' style='font-size:30px;'>0/0</div>
			<div style='padding-top:15px'></div>
			<!--
	<div class='start' style='
		font-size:30px;' onclick='again()'>Try again?</div>
			-->
			<div class='past_result start' style='font-size:30px;'>Past Results</div>
	
			<div style='padding-top:15px;'>
				For more exercises: download the APP for <br />
				Biology Practical Activity &amp; Work Book 1 - 3.<br />
	
				<a href='https://youngbrain.com.ng/app'>
					<div class='start' style='font-size:30px;' onclick='again()'>Biology_App</div>
				</a>
	
				<br /> For more information, visit our facebook page<br /><a
					href="https://www.facebook.com/Youngbrain-publishers-ltd-103972044777696/">Youngbrain Publishers Ltd </a>
			</div>
		</div>
		<div id='labelView' class='co ce'>
			<div class='hh'>Answer All
	
				<div id='ti'> Time: </div>
			</div>
			<style>
				.pa {
					padding: 10px;
					font-size: 20px;
					text-align: left;
				}
	
				.imn {
					margin: auto;
					display: block;
					max-width: 100%;
				}
			</style>
	
			<div class='qq'>
				<div class="pa paj">
					1. Write the classes that the following organisms belong in the spaces
					provided against them.
				</div>
				<table class="tabler">
					<tr class="trA">
						<td>Organisms</td>
						<td>Classes</td>
					</tr>
					<tr>
						<td>
							Mosquito </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
					<tr>
						<td>
							Dogs </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
					<tr>
						<td>
							Cat </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
					<tr>
						<td>
							Maize plant </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
					<tr>
						<td>
							Frog </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
					<tr>
						<td>
							Mango </td>
						<td>
							<input type="text" class="answ" /><span class="resp"></span>
						</td>
					</tr>
				</table>
			</div>
			<div class='qq'>
				<div class="pa paj">
					2. <strong class="u">Identify diagrams A.B.C </strong>
				</div>
	
	
				<div class="fig">
					<strong>fig2.7a:</strong>
				</div>
				<img src="images/fig2.7a.jpg" class="imn" /><br />
				A.
				<input type="text" class="answ" /><span class="resp"></span>
	
				<div class="fig">
					<strong>fig2.7b:</strong>
				</div>
				<img src="images/fig2.7b.jpg" class="imn" /><br />
				B.
				<input type="text" class="answ" /><span class="resp"></span>
	
				<div class="fig">
					<strong>fig2.7c:</strong>
				</div>
				<img src="images/fig2.2b.jpg" class="imn" /><br />
				C.
				<input type="text" class="answ" /><span class="resp"></span>
	
				<div class="pa paj">
					d. Which of these organisms is a cilliate?
	
					<input type="text" class="answ" /><span class="resp"></span>
				</div>
	
			</div>
	
			<div class='qq'>
	
			</div>
			<div class='qq'>
	
			</div>
		</div>
		</body>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js"></script>
<script src="../jq.js"></script>

<script>	

        // Firebase configuration
        const firebaseConfig = {
      apiKey: "AIzaSyDoF2sTPbPLnFzD12UjEa38NvGcGfcerwM",
      authDomain: "biology-fcd02.firebaseapp.com",
      projectId: "biology-fcd02",
      storageBucket: "biology-fcd02.appspot.com",
      messagingSenderId: "118666941690",
      appId: "1:118666941690:web:fa1b89b4f968e8e423e543"
        };

        // Initialize Firebase and Firestore
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

//localStorage.removeItem("quiz_last_performance");
//localStorage.setItem("quiz_last_performance","2024-10-25T18:30:57.916Z");
console.log(localStorage.quiz_last_performance);
	if(localStorage.quiz){
		var quiz_data = localStorage.quiz;
		quiz_data = quiz_data.split('*-*');

		if(quiz_data.length > 2){
			document.getElementById('name').value=quiz_data[0];
			document.getElementById('Uphone').value=quiz_data[1];
			document.getElementById('surname').value=quiz_data[2];
		}
	}else{console.log('testing;')}
/*
	if(localStorage.quiz.name){document.getElementById('name').value=localStorage.quiz.name};
	if(localStorage.quiz.phone){document.getElementById('Uphone').value=localStorage.quiz.phone};
	if(localStorage.quiz.surname){document.getElementById('surname').value=localStorage.quiz.surname};
*/
	document.querySelector("reg_me");
	const form = document.getElementById("reg_me");
	document.getElementById("testo").addEventListener('click', (e)=>{submit_name(e)});
	form.addEventListener('submit', (e)=>{submit_name(e)});
	
		
	var oruko = 'nil',
   pho = 'nil',
	 surname = 'nil';

    // Helper function to get the date of the last Monday
    function getLastMonday() {
        const daysSinceMonday = (dayOfWeek + 6) % 7; // Calculate days since last Monday
        const lastMonday = new Date(today);
        lastMonday.setDate(today.getDate() - daysSinceMonday);
        return lastMonday;
    }
    const today = new Date();
    const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday
    var eligibility = true;

	function submit_name(e){
		e.preventDefault();
		
    //check last performance
    const lastPerformance = localStorage.getItem("quiz_last_performance");

// Check if today is Saturday (6) or Sunday (0)
if (dayOfWeek === 6 || dayOfWeek === 0) {
    let participateMessage = 'You cannot participate on Saturdays and Sundays';
    console.log(participateMessage);
    document.getElementById('messa').innerHTML=participateMessage;
    show_n_hide("loading","reg_page");
		fetchData();

    return eligibility;
} else if (lastPerformance) {
        const lastPerformanceDate = new Date(lastPerformance);
        const lastMonday = getLastMonday();

        // Check if last performance date is before last Monday
        if (lastPerformanceDate < lastMonday) {
            validate_registration();
            
        } else {
            eligibility = false;
            let participateMessage ='You have participated this week with the following phone number<div style="color:blue;">'+quiz_data[1]+'</div>Please check on Saturday. We announce all winners on Saturdays.<br>Thanks';
            console.log(participateMessage);
        document.getElementById('messa').innerHTML=participateMessage;
        show_n_hide("loading","reg_page");
        //$("#score").load("label.php?label=q");
				fetchData();
        }
    } else {
        validate_registration();
    }

	}
  
  function checkIfEligible() {
    const today = new Date();
    const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday
    let eligibility = false;

    // Helper function to get the date of the last Monday
    function getLastMonday() {
        const daysSinceMonday = (dayOfWeek + 6) % 7; // Calculate days since last Monday
        const lastMonday = new Date(today);
        lastMonday.setDate(today.getDate() - daysSinceMonday);
        return lastMonday;
    }

    const lastPerformance = localStorage.getItem("quiz_last_performance");

    // Check if today is Saturday (6) or Sunday (0)
    if (dayOfWeek === 6 || dayOfWeek === 0) {
        let participateMessage = 'You cannot participate on Saturdays and Sundays';
        console.log(participateMessage);
        document.getElementById('messa').innerHTML=participateMessage;
        show_n_hide("loading","reg_page");

        return eligibility;
    } else if (lastPerformance) {
        const lastPerformanceDate = new Date(lastPerformance);
        const lastMonday = getLastMonday();

        // Check if last performance date is before last Monday
        if (lastPerformanceDate < lastMonday) {
            eligibility = true;
            localStorage.setItem("quiz_last_performance", today.toISOString());
            start2();
        } else {
            eligibility = false;
            let participateMessage ='You have participated this week. Please check on Saturday. We announce all winners on Saturdays. Thanks';
            console.log(participateMessage);
        document.getElementById('messa').innerHTML=participateMessage;
        show_n_hide("loading","reg_page");
        }
    } else {
        eligibility = true;
        localStorage.setItem("quiz_last_performance", today.toISOString());
        openGame();
    }

    return eligibility;
}

var current_view = "reg_page",
last_view = "msg";
function show_n_hide(a,b){
  $('.co').css({display:'none'});
  $('#'+a).slideDown();
  //document.getElementById(a).style.display = "block";
  //current_view = a;
  //last_view = b;
}
$('.past_result').click(function(){show_n_hide("scoreBoard","loading")});
$('#back_btn').click(function(){show_n_hide("loading","scoreBoard")});
$('#start_ready').click(function(){start2()});

function validate_registration(){
  
  if ((document.getElementById('Uphone').value).length >10) {
       pho = document.getElementById('Uphone').value;
       document.getElementById('phone_complain').innerHTML='';
   }else{
		document.getElementById('phone_complain').innerHTML="phone number cannot be less than 11 digits";
		return false;
	 }

   if ((document.getElementById('name').value).length >2) {
       oruko = document.getElementById('name').value;
       document.getElementById('name_complain').innerHTML="";
   }else{
		document.getElementById('name_complain').innerHTML="name cannot be less than 3 letters"; 
		return false;
	 }

		if ((document.getElementById('surname').value).length >2) {
				surname = document.getElementById('surname').value;
        document.getElementById('surname_complain').innerHTML="";
		}else{
			document.getElementById('surname_complain').innerHTML="surname cannot be less than 3 letters";
			return false;
		}
    //prepere the playing stage
    show_n_hide("msg","reg_page");
		localStorage.quiz = oruko+'*-*'+pho+'*-*'+surname;
}

var cc = 0;
function UPDATE_APP() {
  var txtName = oruko,
  txtPhone = pho,
  txtScore = cc;
	
  const quizData = {
      name: oruko,
      phone: pho,
      surname: surname,
      subject: 'biology_quiz',
      score : cc
  };
	async function add_data() {
			try {
					// Add data to Firestore collection
					await db.collection("quiz_submissions").add(quizData)
					.then(fetchData());
					alert("Data submitted successfully!");
					
					// Clear form fields
					//document.getElementById("quizForm").reset();
			} catch (error) {
					console.error("Error adding document: ", error);
					alert("Error submitting data. Please try again.");
			}
		}
		add_data();
   /*
  //alert(txt1);
  $.post('label.php',
    {
      name: oruko,
      phone: pho,
      score: cc,
			subject: "biology_quiz"
    },
    function (result) {
      alert('thru here');
      $("#score").load("label.php?label=q");
      //$('#score').html(result);

    });
		*/
}

var tym = 5,
tymbox = document.getElementById('ti');
function ty() {
  if (tym > 0) {
    tym--;
    tymbox.innerHTML = 'Time : ' + tym;
    setTimeout(ty, 1000);
  }
  else {
    tymbox.innerHTML = 'TIME UP! 00:00';
    document.getElementById('ti3').innerHTML = 'TIME UP! 00:00';
    document.getElementById('end').style.display = 'block';
    document.getElementById('labelView').style.display = 'none';

    cc = countSco();
    document.getElementById('sco').innerHTML = 'you scored: ' + cc + '<div style="font-size:16px;">We will contact you on friday if you are the highest scorer for the week <br />You can try again next week.</div>';
      
      UPDATE_APP();
      /*
    if (phoneNo !== '080_TEST') {
    }
    */
  }
}

function passq() {
  document.getElementById('scoreBoard').style.display = 'block';
  document.getElementById('end').style.display = 'none';
}

function backq() {
  document.getElementById('scoreBoard').style.display = 'none';
  document.getElementById('end').style.display = 'block';
}
function again() {
  document.getElementById('msg').style.display = 'block';
  document.getElementById('end').style.display = 'none';
}

var fname = "!_This_is_a_Test_Mode",
phoneNo = "080_TEST";
localStorage.season = 0;
function start2() {

  const today = new Date();
  const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday

  localStorage.setItem("quiz_last_performance", today.toISOString());
  tym = 3; // 181;
  document.getElementById('msg').style.display = 'none';
  document.getElementById('scoreBoard').style.display = 'none';
  document.getElementById('labelView').style.display = 'block';
  setTimeout(ty, 1000);
  /*
  if (localStorage.quiz_last_performance == phoneNo) {
    passq();
    document.getElementById('message').innerHTML = 'You have attempted <br /> You can only participate once in a week <br /> You visit our facebook page<br/><a href="https://www.facebook.com/Youngbrain-publishers-ltd-103972044777696/">Youngbrain publishers Ltd </a> ';
  } else {
    tym = 3; // 181;
    document.getElementById('msg').style.display = 'none';
    document.getElementById('scoreBoard').style.display = 'none';
    document.getElementById('labelView').style.display = 'block';
    setTimeout(ty, 1000);
  }
    */
}
function countSco() {
  var mkk = 0;

  for (let ii = 0; ii < totSco.length; ii++) {
    mkk = mkk + totSco[ii];
  }

  return mkk;
}

/*** marker **/

var g = document.getElementsByClassName('answ'),
gg = document.getElementsByClassName('resp'),
z = 'x',
totSco = [];
function myFunction() {
  for (var i = 0, len = g.length; i < len; i++) {
    totSco[i] = 0;
    //if(answer[i][0].length < 1){gg[i].innerHTML=xw}else{ gg[i].innerHTML=answer[i][0];}
    (function (index) {
      g[i].onkeyup = function () {
        //alert(index+1)  ;
        if (answer[index][0].length < 1) { gg[index].innerHTML = xw } else {

          var y = g[index].value.toLowerCase();
          xx = answer[index];
          mk = '';
          anso = 'f';
          //alert(xx.length);


          for (var ii = 0, len = xx.length; ii < len; ii++) {
            x2 = xx[ii].toLowerCase();
            if (y == x2) {
              anso = 't';
              /*
              return anso;
              break;
              */
            }
          }

          if (anso == 't') {
            z = "<img src='images/correctx.jpg' alt='correct' class='mk' />";
            totSco[index] = 1;
          }
          else {
            z = "<img src='images/wrongx.jpg' alt='wrong' class='mk' />";
            totSco[index] = 0;
          }//{z= x2}
          //document.getElementById('demo').innerHTML=z;
          gg[index].innerHTML = z;
        }
      }
    })(i);

  }
}
setTimeout(myFunction, 3000);


var answer = [

  ['Insecta', 'insects', 'insect'],
  ['Mammalia', 'mammals'],
  ['Mammalia', 'mammals'],
  ['Angiosperms', 'Angiosperm'],
  ['Amphibia', 'Amphibians', 'Amphibian'],
  ['Angiosperms', 'Angiosperm'],
  //2
  ['amoeba'],
  ['flagellum', 'flagellia'],
  ['paramecium'],
  ['paramecium']
];

async function fetchData() {
            const dataList = document.getElementById("data-list");

            try {
                const querySnapshot = await db.collection("quiz_submissions")
                    .where("subject", "==", "biology_quiz")
                    .get();

                let tabili = '<table>';
										querySnapshot.forEach((doc) => {
                    const data = doc.data();
										
										tabili += `<tr>
												<td>${data.name}</td>
												<td>${data.phone}</td>
												<td>${data.score}</td>
											</tr>`;
                });

								tabili += "</table>";
								dataList.innerHTML = tabili;

            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }
</script>
		</html>